<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopping Cart - AquaSphere</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts Poppins -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        /* Prevent layout shift - set navbar size immediately */
        html {
            scroll-padding-top: 70px;
        }
        
        body {
            font-family: 'Poppins', sans-serif !important;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            min-height: 100vh;
            padding-top: 70px !important; /* Fixed navbar height - match dashboard */
            overflow-x: hidden;
            /* Prevent any layout shifts */
            overflow-y: auto;
        }
        
        /* Navbar */
        /* Navbar Styles - Fixed Dimensions */
        .navbar {
            background: rgba(255, 255, 255, 0.95) !important;
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
            height: 70px !important;
            min-height: 70px !important;
            max-height: 70px !important;
            padding: 0 !important;
            margin: 0 !important;
            line-height: 70px !important;
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            right: 0 !important;
            width: 100% !important;
            z-index: 1000 !important;
            /* Prevent any transitions that could cause shake */
            transition: none !important;
        }
        
        .navbar .container {
            height: 70px !important;
            display: flex;
            align-items: center;
        }
        
        .navbar-brand {
            font-weight: 700;
            font-size: 24px;
            color: #0ea5e9 !important;
            display: flex !important;
            align-items: center !important;
            height: 70px !important;
            padding: 0 !important;
            margin: 0 !important;
            line-height: 70px !important;
        }
        
        .navbar-brand:hover {
            color: #0369a1 !important;
        }
        
        .navbar-brand img {
            height: 45px !important;
            width: auto !important;
            margin-right: 10px !important;
            display: block !important;
        }
        
        .navbar-collapse {
            height: 70px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: flex-end !important;
            flex-grow: 1 !important;
        }
        
        .navbar-nav {
            height: 70px !important;
            display: flex !important;
            align-items: center !important;
            margin: 0 !important;
            gap: 0.5rem;
        }
        
        .nav-item {
            height: 70px !important;
            display: flex !important;
            align-items: center !important;
        }
        
        .nav-link {
            font-weight: 500;
            color: #4a5568 !important;
            padding: 0 16px !important;
            height: 70px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            margin: 0 !important;
            line-height: 70px !important;
            position: relative;
            transition: color 0.3s ease;
            border-radius: 10px;
        }
        
        .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 3px;
            bottom: 0;
            left: 50%;
            background: linear-gradient(90deg, #0ea5e9, #0369a1);
            transition: all 0.3s ease;
            transform: translateX(-50%);
        }
        
        .nav-link:hover::after,
        .nav-link.active::after {
            width: 80%;
        }
        
        .nav-link:hover {
            color: #0ea5e9 !important;
            background: rgba(14, 165, 233, 0.1);
        }
        
        .nav-link.active {
            color: #0ea5e9 !important;
            background: rgba(14, 165, 233, 0.1);
        }
        
        /* Icon sizing for navbar icons */
        .nav-link i {
            font-size: 20.8px;
            display: block;
        }
        
        /* Cart badge styling for cart page */
        .cart-badge {
            position: absolute;
            top: 5px;
            right: -5px;
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            min-width: 20px;
            min-height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: 700;
            border: 2px solid white;
            box-shadow: 0 2px 6px rgba(245, 158, 11, 0.4);
            /* Prevent layout shift - always reserve space */
            box-sizing: border-box;
        }
        
        .navbar-toggler {
            height: 40px !important;
            width: 40px !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        
        
        /* Main Content */
        .main-content {
            padding: 2rem 0;
            padding-top: 1rem; /* Reduced since body already has padding-top */
        }
        
        .page-title {
            font-size: 2rem;
            font-weight: 700;
            color: #0369a1;
            margin-bottom: 0.25rem;
        }
        
        .page-subtitle {
            color: #64748b;
            font-size: 1.1rem;
            margin-bottom: 2rem;
        }
        
        /* Cart Container */
        .cart-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            margin-top: 1rem;
            padding: 1.25rem;
            margin-bottom: 1rem;
        }
        
        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding-bottom: 1rem;
            border-bottom: 2px solid #f1f5f9;
            margin-bottom: 1rem;
        }
        
        .cart-header h2 {
            font-size: 1.8rem;
            font-weight: 700;
            color: #0369a1;
            margin: 0;
        }
        
        .item-count-badge {
            background: linear-gradient(135deg, #0ea5e9, #0284c7);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(14, 165, 233, 0.3);
            white-space: nowrap;
        }
        
        /* Empty Cart */
        .empty-cart {
            text-align: center;
            padding: 4rem 2rem;
        }
        
        .empty-cart i {
            font-size: 5rem;
            color: #cbd5e1;
            margin-bottom: 1.5rem;
        }
        
        .empty-cart h3 {
            font-size: 1.5rem;
            color: #475569;
            margin-bottom: 0.5rem;
        }
        
        .empty-cart p {
            color: #94a3b8;
            margin-bottom: 2rem;
        }
        
        .btn-continue-shopping {
            background: linear-gradient(135deg, #0ea5e9, #0284c7);
            border: none;
            color: white;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 4px 12px rgba(14, 165, 233, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .btn-continue-shopping::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }
        
        .btn-continue-shopping:hover::before {
            left: 100%;
        }
        
        .btn-continue-shopping i {
            display: inline-block;
            line-height: 1;
            font-size: 0.95rem;
            vertical-align: middle;
            margin: 0;
            padding: 0;
        }
        
        .btn-continue-shopping:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(14, 165, 233, 0.4);
            color: white;
        }
        
        .btn-continue-shopping:active {
            transform: translateY(-1px);
        }
        
        /* Cart Items */
        .cart-item {
            display: flex;
            align-items: center;
            padding: 1rem;
            border: 1px solid #f1f5f9;
            border-radius: 15px;
            margin-bottom: 0.75rem;
            transition: all 0.3s ease;
            background: white;
        }
        
        .cart-item:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border-color: #e0f2fe;
        }
        
        .item-checkbox {
            margin-right: 1rem;
        }
        
        .item-checkbox input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: #0ea5e9;
        }
        
        .item-image {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #0ea5e9, #0284c7);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
            flex-shrink: 0;
        }
        
        .item-image i {
            font-size: 2rem;
            color: white;
        }
        
        .item-details {
            flex: 1;
            margin-right: 1rem;
        }
        
        .item-name {
            font-size: 1.1rem;
            font-weight: 600;
            color: #0f172a;
            margin-bottom: 0.25rem;
        }
        
        .item-price {
            font-size: 0.95rem;
            color: #64748b;
        }
        
        .item-quantity {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-right: 1rem;
        }
        
        .quantity-controls {
            display: flex;
            align-items: stretch;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            overflow: hidden;
            width: 120px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
            flex-wrap: nowrap;
        }
        
        .quantity-controls:hover {
            border-color: #0ea5e9;
            box-shadow: 0 4px 8px rgba(14, 165, 233, 0.15);
        }
        
        .quantity-controls:focus-within {
            border-color: #0ea5e9;
            box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.1);
        }
        
        .quantity-btn {
            width: 40px;
            height: 40px;
            border: none;
            background: #f8fafc;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.2s ease, color 0.2s ease;
            color: #475569;
            font-weight: 600;
            font-size: 1.2rem;
            position: relative;
            flex-shrink: 0;
            min-width: 40px;
            margin: 0;
            padding: 0;
        }
        
        .quantity-btn.decrease {
            border-right: 1px solid #e2e8f0;
        }
        
        .quantity-btn.increase {
            border-left: 1px solid #e2e8f0;
        }
        
        .quantity-controls:hover .quantity-btn.decrease {
            border-right-color: #0ea5e9;
        }
        
        .quantity-controls:hover .quantity-btn.increase {
            border-left-color: #0ea5e9;
        }
        
        .quantity-btn:hover {
            background: #e0f2fe;
            color: #0ea5e9;
        }
        
        .quantity-btn:active {
            background: #bae6fd;
            transform: scale(0.95);
        }
        
        .quantity-btn.decrease {
            border-radius: 8px 0 0 8px;
        }
        
        .quantity-btn.increase {
            border-radius: 0 8px 8px 0;
        }
        
        .quantity-input {
            flex: 1;
            height: 40px;
            border: none;
            border-left: 1px solid #e2e8f0;
            border-right: 1px solid #e2e8f0;
            text-align: center;
            font-weight: 700;
            font-size: 0.95rem;
            color: #0369a1;
            background: white;
            padding: 0 5px;
            min-width: 40px;
            display: block;
            -moz-appearance: textfield;
            margin: 0;
        }
        
        .quantity-controls:hover .quantity-input {
            border-left-color: #0ea5e9;
            border-right-color: #0ea5e9;
        }
        
        .quantity-input:focus {
            outline: none;
            background: #f0f9ff;
            border-bottom: 2px solid #0ea5e9;
        }
        
        .quantity-controls:focus-within .quantity-input {
            border-left-color: #0ea5e9;
            border-right-color: #0ea5e9;
        }
        
        .quantity-input::-webkit-inner-spin-button,
        .quantity-input::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        
        .item-subtotal {
            font-size: 1.3rem;
            font-weight: 700;
            color: #0ea5e9;
            min-width: 100px;
            text-align: right;
            margin-right: 1rem;
        }
        
        .item-remove {
            background: #fee2e2;
            border: none;
            color: #ef4444;
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .item-remove:hover {
            background: #ef4444;
            color: white;
            transform: scale(1.1);
        }
        
        /* Cart Summary */
        .cart-summary {
            background: white;
            border-radius: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            padding: 1.25rem;
            width: 100%;
        }
        
        .cart-summary-wrapper {
            position: static;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            width: 100%;
            margin-top: 1rem; /* Extra spacing to avoid navbar overlap */
        }
        
        .cart-summary {
            width: 100%;
            max-width: 100%;
        }
        
        /* Ensure body and html don't interfere */
        html, body {
            overflow-x: hidden;
            position: relative;
        }
        
        /* Ensure no parent creates containing block */
        main,
        .main-content,
        .main-content .container,
        .main-content .row {
            transform: none !important;
            perspective: none !important;
            filter: none !important;
            will-change: auto !important;
        }
        
        @media (max-width: 991px) {
            .cart-summary-wrapper {
                width: 100%;
            }
        }
        
        .cart-summary::-webkit-scrollbar {
            width: 6px;
        }
        
        .cart-summary::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 10px;
        }
        
        .cart-summary::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 10px;
        }
        
        .cart-summary::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        
        .summary-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: #0369a1;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid #f1f5f9;
        }
        
        .summary-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            color: #475569;
        }
        
        .summary-row.total {
            border-top: 2px solid #f1f5f9;
            margin-top: 0.75rem;
            padding-top: 0.75rem;
            font-size: 1.15rem;
            font-weight: 700;
            color: #0369a1;
        }
        
        .summary-label {
            font-weight: 500;
        }
        
        .summary-value {
            font-weight: 600;
            color: #0f172a;
        }
        
        .summary-row.total .summary-value {
            font-size: 1.5rem;
            color: #0ea5e9;
        }
        
        .btn-checkout {
            width: 100%;
            background: linear-gradient(135deg, #0ea5e9, #0284c7);
            border: none;
            color: white;
            padding: 12px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 0.95rem;
            margin-top: 1rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(14, 165, 233, 0.3);
        }
        
        .btn-checkout:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(14, 165, 233, 0.4);
            color: white;
        }
        
        .btn-checkout:disabled {
            background: #cbd5e1;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        /* Select All */
        .select-all {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem;
            background: #f8fafc;
            border-radius: 10px;
            margin-bottom: 1rem;
        }
        
        .select-all input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: #0ea5e9;
        }
        
        .select-all label {
            font-weight: 600;
            color: #475569;
            cursor: pointer;
            margin: 0;
        }
        
        .btn-delete-all {
            margin-left: auto;
            background: #fee2e2;
            border: 2px solid #ef4444;
            color: #ef4444;
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
        }
        
        .btn-delete-all:hover {
            background: #ef4444;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(239, 68, 68, 0.3);
        }
        
        /* Delivery Address Section */
        .delivery-address-section {
            padding: 0;
        }
        
        .address-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #f1f5f9;
            margin-bottom: 1.5rem;
        }
        
        .cart-summary .delivery-address-section {
            margin-top: 0;
        }
        
        .address-header i {
            color: #ef4444;
            font-size: 1.3rem;
        }
        
        .address-header span {
            font-size: 1.3rem;
            font-weight: 700;
            color: #ef4444;
        }
        
        .address-content {
            min-height: 80px;
        }
        
        .empty-address {
            text-align: center;
            padding: 2rem;
            color: #94a3b8;
        }
        
        .empty-address p {
            margin-bottom: 1rem;
            font-size: 0.95rem;
        }
        
        .btn-add-address {
            background: linear-gradient(135deg, #0ea5e9, #0284c7);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-add-address:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(14, 165, 233, 0.3);
            color: white;
        }
        
        .address-display {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }
        
        .address-display:hover {
            border-color: #0ea5e9;
            box-shadow: 0 4px 12px rgba(14, 165, 233, 0.1);
        }
        
        .address-header-row {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
            gap: 1rem;
        }
        
        .address-info {
            flex: 1;
        }
        
        .address-name-phone {
            font-size: 1.2rem;
            font-weight: 700;
            color: #0369a1;
            margin-bottom: 0.5rem;
            line-height: 1.4;
        }
        
        .address-name-phone strong {
            display: block;
            margin-bottom: 0.25rem;
        }
        
        .address-name-phone span {
            color: #64748b;
            font-weight: 500;
            font-size: 0.95rem;
        }
        
        .address-text {
            color: #475569;
            line-height: 1.8;
            font-size: 0.95rem;
            background: white;
            padding: 1rem;
            border-radius: 8px;
            border-left: 3px solid #0ea5e9;
            margin-top: 0.75rem;
        }
        
        .address-actions {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 0.75rem;
            flex-shrink: 0;
        }
        
        .badge-default {
            background: linear-gradient(135deg, #fff7ed, #ffedd5);
            color: #ea580c;
            border: 2px solid #ea580c;
            padding: 6px 14px;
            border-radius: 6px;
            font-size: 0.85rem;
            font-weight: 700;
            box-shadow: 0 2px 4px rgba(234, 88, 12, 0.2);
            white-space: nowrap;
        }
        
        .address-buttons {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-change-address {
            background: linear-gradient(135deg, #0ea5e9, #0284c7);
            border: none;
            color: white;
            font-weight: 600;
            cursor: pointer;
            padding: 8px 16px;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            box-shadow: 0 2px 4px rgba(14, 165, 233, 0.2);
            white-space: nowrap;
        }
        
        .btn-change-address:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(14, 165, 233, 0.3);
            color: white;
        }
        
        .btn-delete-address {
            background: #fee2e2;
            border: 2px solid #ef4444;
            color: #ef4444;
            font-weight: 600;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(239, 68, 68, 0.2);
            min-width: 40px;
        }
        
        .btn-delete-address:hover {
            background: #ef4444;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(239, 68, 68, 0.3);
        }
        
        /* Delete Confirmation Modal - Unique Design */
        .delete-confirm-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 42, 0.7);
            backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            animation: fadeInModal 0.25s ease;
        }
        
        @keyframes fadeInModal {
            from {
                opacity: 0;
                backdrop-filter: blur(0px);
            }
            to {
                opacity: 1;
                backdrop-filter: blur(8px);
            }
        }
        
        .delete-confirm-content {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border-radius: 24px;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.4), 0 0 0 1px rgba(255, 255, 255, 0.1);
            max-width: 420px;
            width: 90%;
            animation: modalScaleIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            overflow: hidden;
            position: relative;
        }
        
        @keyframes modalScaleIn {
            from {
                transform: scale(0.85) translateY(20px);
                opacity: 0;
            }
            to {
                transform: scale(1) translateY(0);
                opacity: 1;
            }
        }
        
        .delete-confirm-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ef4444, #f59e0b, #ef4444);
            background-size: 200% 100%;
            animation: gradientShift 2s ease infinite;
        }
        
        @keyframes gradientShift {
            0%, 100% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
        }
        
        .delete-confirm-icon-wrapper {
            display: flex;
            justify-content: center;
            padding: 2rem 2rem 1rem;
            position: relative;
        }
        
        .delete-confirm-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 24px rgba(239, 68, 68, 0.25);
            position: relative;
            animation: iconPulse 2s ease-in-out infinite;
        }
        
        @keyframes iconPulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 8px 24px rgba(239, 68, 68, 0.25);
            }
            50% {
                transform: scale(1.05);
                box-shadow: 0 12px 32px rgba(239, 68, 68, 0.35);
            }
        }
        
        .delete-confirm-icon i {
            font-size: 2.5rem;
            color: #ef4444;
            animation: iconShake 0.5s ease;
        }
        
        @keyframes iconShake {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-5deg); }
            75% { transform: rotate(5deg); }
        }
        
        .delete-confirm-body {
            padding: 0 2rem 1.5rem;
            text-align: center;
        }
        
        .delete-confirm-body h3 {
            font-size: 1.5rem;
            font-weight: 700;
            color: #0f172a;
            margin: 0 0 0.75rem 0;
        }
        
        .delete-confirm-body p {
            font-size: 1rem;
            color: #64748b;
            margin: 0;
            line-height: 1.6;
        }
        
        .delete-confirm-footer {
            padding: 1.25rem 2rem 2rem;
            display: flex;
            gap: 0.75rem;
            justify-content: center;
        }
        
        .btn-confirm-cancel,
        .btn-confirm-delete {
            padding: 12px 28px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 2px solid;
            flex: 1;
            max-width: 140px;
        }
        
        .btn-confirm-cancel {
            background: white;
            border-color: #e2e8f0;
            color: #475569;
        }
        
        .btn-confirm-cancel:hover {
            background: #f8fafc;
            border-color: #cbd5e1;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .btn-confirm-delete {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            border-color: #ef4444;
            color: white;
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
        }
        
        .btn-confirm-delete:hover {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            border-color: #dc2626;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(239, 68, 68, 0.4);
        }
        
        /* Checkout Loading Modal */
        .checkout-loading-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10001;
            animation: fadeInModal 0.3s ease;
        }
        
        .checkout-loading-content {
            background: linear-gradient(135deg, #ffffff 0%, #f0f9ff 100%);
            border-radius: 24px;
            padding: 3rem 2.5rem;
            text-align: center;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.4);
            max-width: 400px;
            width: 90%;
            animation: modalScaleIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
            overflow: hidden;
        }
        
        .checkout-loading-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #0ea5e9, #0284c7, #06b6d4, #0ea5e9);
            background-size: 200% 100%;
            animation: gradientShift 2s ease infinite;
        }
        
        .checkout-loading-icon {
            width: 100px;
            height: 100px;
            margin: 0 auto 1.5rem;
            position: relative;
        }
        
        .checkout-loading-spinner {
            width: 100%;
            height: 100%;
            border: 4px solid #e0f2fe;
            border-top: 4px solid #0ea5e9;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .checkout-loading-icon i {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2.5rem;
            color: #0ea5e9;
            animation: iconBounce 1.5s ease-in-out infinite;
        }
        
        @keyframes iconBounce {
            0%, 100% {
                transform: translate(-50%, -50%) scale(1);
            }
            50% {
                transform: translate(-50%, -50%) scale(1.1);
            }
        }
        
        .checkout-loading-text {
            font-size: 1.25rem;
            font-weight: 600;
            color: #0f172a;
            margin: 0;
        }
        
        .checkout-loading-subtext {
            font-size: 0.95rem;
            color: #64748b;
            margin: 0.5rem 0 0 0;
        }
        
        /* Address Modal - Unique Design */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 42, 0.75);
            backdrop-filter: blur(12px);
            z-index: 10000;
            align-items: center;
            justify-content: center;
            padding: 20px;
            animation: fadeInModal 0.3s ease;
        }
        
        .modal-overlay.active {
            display: flex;
        }
        
        .address-modal {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 50%, #f0f9ff 100%);
            border-radius: 28px;
            width: 100%;
            max-width: 720px;
            max-height: 92vh;
            overflow: hidden;
            box-shadow: 0 30px 100px rgba(0, 0, 0, 0.4), 0 0 0 1px rgba(255, 255, 255, 0.1);
            animation: addressModalSlideIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            display: flex;
            flex-direction: column;
            position: relative;
        }
        
        @keyframes addressModalSlideIn {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(30px) rotateX(10deg);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0) rotateX(0deg);
            }
        }
        
        .address-modal::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #0ea5e9, #0284c7, #06b6d4, #0891b2, #0ea5e9);
            background-size: 200% 100%;
            animation: gradientShift 3s ease infinite;
            z-index: 1;
        }
        
        .address-modal::after {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(14, 165, 233, 0.08) 0%, transparent 70%);
            animation: rotateGradient 20s linear infinite;
            pointer-events: none;
        }
        
        @keyframes rotateGradient {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }
        
        .modal-header {
            background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 50%, #06b6d4 100%);
            padding: 2rem 2rem 1.5rem;
            border-bottom: none;
            border-radius: 28px 28px 0 0;
            position: relative;
            overflow: hidden;
        }
        
        .modal-header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.15) 0%, transparent 70%);
            animation: rotateGradient 15s linear infinite;
        }
        
        .modal-header h2 {
            font-size: 1.75rem;
            font-weight: 800;
            color: white;
            margin: 0;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            position: relative;
            z-index: 1;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .modal-header h2::before {
            content: 'üìç';
            font-size: 1.5rem;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
            animation: iconFloat 3s ease-in-out infinite;
        }
        
        @keyframes iconFloat {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-5px);
            }
        }
        
        .modal-body {
            background: transparent;
            flex: 1;
            overflow-y: auto;
            padding: 2rem 2rem 1.5rem;
            max-height: calc(92vh - 250px);
            position: relative;
            z-index: 1;
        }
        
        .modal-body::-webkit-scrollbar {
            width: 8px;
        }
        
        .modal-body::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 10px;
        }
        
        .modal-body::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #0ea5e9, #0284c7);
            border-radius: 10px;
        }
        
        .modal-body::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #0284c7, #0369a1);
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
        }
        
        .form-group {
            margin-bottom: 0.75rem;
            position: relative;
        }
        
        .form-group.error input,
        .form-group.error select {
            border-color: #ef4444;
            background: #fef2f2;
        }
        
        .form-group.error input:focus,
        .form-group.error select:focus {
            border-color: #ef4444;
            box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.12), 0 4px 12px rgba(239, 68, 68, 0.15);
        }
        
        .form-group .error-message {
            display: none;
            margin-top: 0.4rem;
            padding: 0.5rem 0.75rem;
            background: linear-gradient(135deg, #fee2e2, #fecaca);
            border: 1px solid #fca5a5;
            border-radius: 8px;
            color: #991b1b;
            font-size: 0.85rem;
            font-weight: 500;
            position: relative;
            animation: errorSlideIn 0.3s ease;
            box-shadow: 0 2px 8px rgba(239, 68, 68, 0.15);
        }
        
        .form-group.error .error-message {
            display: block;
        }
        
        .form-group .error-message::before {
            content: '‚ö†Ô∏è';
            margin-right: 0.5rem;
            font-size: 0.9rem;
        }
        
        @keyframes errorSlideIn {
            from {
                opacity: 0;
                transform: translateY(-5px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #0f172a;
            font-size: 0.9rem;
            letter-spacing: 0.01em;
        }
        
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 0.95rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: white;
            autocomplete: off;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.02);
        }
        
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #0ea5e9;
            box-shadow: 0 0 0 4px rgba(14, 165, 233, 0.12), 0 4px 12px rgba(14, 165, 233, 0.15);
            background: linear-gradient(to bottom, #ffffff, #f8faff);
            transform: translateY(-1px);
        }
        
        .form-group.error input:focus,
        .form-group.error select:focus {
            border-color: #ef4444;
            box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.12), 0 4px 12px rgba(239, 68, 68, 0.15);
        }
        
        .form-group input:hover,
        .form-group select:hover {
            border-color: #cbd5e1;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .form-group.error input:hover,
        .form-group.error select:hover {
            border-color: #f87171;
        }
        
        .form-group.full-width {
            grid-column: 1 / -1;
        }
        
        .form-group select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23475569' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 15px center;
            padding-right: 40px;
        }
        
        .map-placeholder {
            width: 100%;
            height: 120px;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 2px dashed #0ea5e9;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 0.75rem;
            position: relative;
            overflow: hidden;
        }
        
        .map-placeholder::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(14, 165, 233, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(2, 132, 199, 0.1) 0%, transparent 50%);
            animation: mapPulse 4s ease-in-out infinite;
        }
        
        @keyframes mapPulse {
            0%, 100% {
                opacity: 0.5;
            }
            50% {
                opacity: 0.8;
            }
        }
        
        .map-placeholder::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(90deg, rgba(14, 165, 233, 0.1) 1px, transparent 1px),
                linear-gradient(rgba(14, 165, 233, 0.1) 1px, transparent 1px);
            background-size: 25px 25px;
            opacity: 0.4;
        }
        
        .btn-add-location {
            background: linear-gradient(135deg, #ffffff, #f8faff);
            border: 2px solid #0ea5e9;
            color: #0ea5e9;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1;
            position: relative;
            box-shadow: 0 4px 12px rgba(14, 165, 233, 0.2);
        }
        
        .btn-add-location:hover {
            background: linear-gradient(135deg, #0ea5e9, #0284c7);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(14, 165, 233, 0.35);
        }
        
        .btn-add-location:active {
            transform: translateY(0);
        }
        
        .label-section {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .label-section span {
            font-weight: 600;
            color: #475569;
            font-size: 0.85rem;
        }
        
        .label-buttons {
            display: flex;
            gap: 0.5rem;
        }
        
        .label-btn {
            padding: 12px 28px;
            border: 2px solid #e2e8f0;
            background: white;
            color: #94a3b8;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 0.95rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.02);
        }
        
        .label-btn:hover {
            border-color: #0ea5e9;
            color: #0ea5e9;
            background: #f0f9ff;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(14, 165, 233, 0.15);
        }
        
        .label-btn.active {
            border-color: #0ea5e9;
            background: linear-gradient(135deg, #0ea5e9, #0284c7);
            color: white;
            box-shadow: 0 4px 16px rgba(14, 165, 233, 0.4);
            transform: translateY(-2px);
        }
        
        .modal-footer {
            padding: 1.5rem 2rem;
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            border-top: 2px solid #f1f5f9;
            background: linear-gradient(to bottom, #ffffff, #f8fafc);
            border-radius: 0 0 28px 28px;
            position: relative;
            z-index: 1;
        }
        
        .btn-cancel {
            padding: 12px 28px;
            border: 2px solid #e2e8f0;
            background: white;
            color: #64748b;
            border-radius: 12px;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.02);
        }
        
        .btn-cancel:hover {
            border-color: #cbd5e1;
            background: #f8fafc;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .btn-submit {
            padding: 12px 28px;
            border: none;
            background: linear-gradient(135deg, #0ea5e9, #0284c7);
            color: white;
            border-radius: 12px;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 16px rgba(14, 165, 233, 0.35);
        }
        
        .btn-submit:hover {
            background: linear-gradient(135deg, #0284c7, #0369a1);
            transform: translateY(-2px);
            box-shadow: 0 6px 24px rgba(14, 165, 233, 0.45);
        }
        
        .btn-submit:active {
            transform: translateY(0);
        }
        
        .btn-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(234, 88, 12, 0.3);
        }
        
        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .address-display {
                flex-direction: column;
            }
            
            .address-actions {
                width: 100%;
                justify-content: space-between;
            }
        }
        
        /* Pagination */
        .pagination-container {
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 2px solid #f1f5f9;
        }
        
        .pagination {
            margin: 0;
        }
        
        .pagination .page-link {
            color: #0ea5e9;
            border: 2px solid #e2e8f0;
            padding: 10px 16px;
            margin: 0 4px;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .pagination .page-link:hover {
            background: #e0f2fe;
            border-color: #0ea5e9;
            color: #0ea5e9;
        }
        
        .pagination .page-item.active .page-link {
            background: linear-gradient(135deg, #0ea5e9, #0284c7);
            border-color: #0ea5e9;
            color: white;
        }
        
        .pagination .page-item.disabled .page-link {
            color: #cbd5e1;
            border-color: #e2e8f0;
            cursor: not-allowed;
        }
        
        /* Footer Styles */
        .footer {
            background: #0369a1;
            color: white;
            padding: 20px 0 15px;
            margin-top: 4rem;
        }
        
        .footer-title {
            font-size: 0.95rem;
            font-weight: 700;
            margin-bottom: 0.7rem;
        }
        
        .footer-link {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: all 0.3s ease;
            display: block;
            margin-bottom: 0.3rem;
        }
        
        .footer-link:hover {
            color: white;
            transform: translateX(5px);
        }
        
        .social-icons {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .social-icons a {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            transition: all 0.3s ease;
        }
        
        .social-icons a:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-3px);
        }
        
        @media (max-width: 768px) {
            .cart-item {
                flex-wrap: wrap;
            }
            
            .item-details {
                flex-basis: 100%;
                margin-bottom: 1rem;
            }
            
            .item-quantity {
                margin-right: 0;
            }
            
            .item-subtotal {
                margin-right: 0;
                margin-left: auto;
            }
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <img src="systemlogo.png" alt="AquaSphere Logo">
                AquaSphere
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="dashboard.html">
                            <i class="fas fa-home"></i>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="cart.html" style="position: relative;">
                            <i class="fas fa-shopping-cart"></i>
                            <span class="cart-badge" id="cartCount">0</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">
                            <i class="fas fa-box"></i>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">
                            <i class="fas fa-cog"></i>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            
            <div class="row">
                <!-- Cart Items -->
                <div class="col-lg-8">
                    <div class="cart-container">
                        <div class="cart-header">
                            <div>
                                <h2>Shopping Cart</h2>
                                <p class="page-subtitle" style="margin: 0.5rem 0 0 0; font-size: 0.95rem;">Review your items before checkout</p>
                            </div>
                            <div class="item-count-badge" id="itemCount">0 items</div>
                        </div>
                        
                        <!-- Select All -->
                        <div class="select-all">
                            <input type="checkbox" id="selectAll" onchange="toggleSelectAll()">
                            <label for="selectAll">Select All</label>
                            <button type="button" class="btn-delete-all" id="deleteAllBtn" onclick="deleteAllSelected()" style="display: none;">
                                <i class="fas fa-trash me-2"></i>Delete All
                            </button>
                        </div>
                        
                        <!-- Cart Items List -->
                        <div id="cartItemsList">
                            <!-- Items will be dynamically inserted here -->
                        </div>
                        
                        <!-- Pagination -->
                        <div id="paginationContainer" class="pagination-container" style="display: none;">
                            <nav aria-label="Cart pagination">
                                <ul class="pagination justify-content-center" id="pagination">
                                    <!-- Pagination buttons will be dynamically inserted here -->
                                </ul>
                            </nav>
                        </div>
                        
                        <!-- Empty Cart State -->
                        <div id="emptyCart" class="empty-cart" style="display: none;">
                            <i class="fas fa-shopping-cart"></i>
                            <h3>Your cart is empty</h3>
                            <p>Looks like you haven't added any items to your cart yet.</p>
                            <a href="dashboard.html" class="btn btn-continue-shopping">
                                <i class="fas fa-arrow-left"></i>
                                Continue Shopping
                            </a>
                        </div>
                    </div>
                </div>
                
                <!-- Cart Summary -->
                <div class="col-lg-4">
                    <div class="cart-summary-wrapper">
                        <div class="cart-summary">
                            <h3 class="summary-title">Order Summary</h3>
                            
                            <div class="summary-row">
                                <span class="summary-label">Subtotal</span>
                                <span class="summary-value" id="subtotal">‚Ç±0.00</span>
                            </div>
                            
                            <div class="summary-row">
                                <span class="summary-label">Delivery Fee</span>
                                <span class="summary-value" id="deliveryFee">‚Ç±50.00</span>
                            </div>
                            
                            <div class="summary-row total">
                                <span class="summary-label">Total</span>
                                <span class="summary-value" id="total">‚Ç±0.00</span>
                            </div>
                            
                            <button class="btn-checkout" id="checkoutBtn" onclick="proceedToCheckout()" disabled>
                                <i class="fas fa-credit-card me-2"></i>
                                Proceed to Checkout
                            </button>
                            
                            <a href="dashboard.html" class="btn btn-continue-shopping w-100 mt-2" style="justify-content: center;">
                                <i class="fas fa-arrow-left"></i>
                                Continue Shopping
                            </a>
                        </div>
                        
                        <!-- Delivery Address Section -->
                        <div class="cart-summary">
                            <div class="delivery-address-section" id="deliveryAddressSection">
                            <div class="address-header">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>Delivery Address</span>
                            </div>
                            <div id="addressContent" class="address-content">
                                <div class="empty-address" id="emptyAddress">
                                    <p>No delivery address set</p>
                                    <button class="btn-add-address" onclick="openAddressModal()">
                                        <i class="fas fa-plus me-2"></i>
                                        Add Delivery Address
                                    </button>
                                </div>
                                <div class="address-display" id="addressDisplay" style="display: none;">
                                    <div class="address-header-row">
                                        <div class="address-info">
                                            <div class="address-name-phone">
                                                <strong id="addressName"></strong>
                                                <span id="addressPhone"></span>
                                            </div>
                                        </div>
                                        <div class="address-actions">
                                            <span class="badge-default" id="defaultBadge" style="display: none;">Default</span>
                                        </div>
                                    </div>
                                    <div class="address-text" id="addressText"></div>
                                    <div class="address-buttons" style="margin-top: 1rem; display: flex; justify-content: flex-end; gap: 0.5rem;">
                                        <button class="btn-change-address" onclick="openAddressModal()">Change</button>
                                        <button class="btn-delete-address" onclick="deleteAddress()" title="Delete address">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Address Modal -->
    <div class="modal-overlay" id="addressModal" onclick="closeAddressModal(event)">
        <div class="address-modal" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2>New Address</h2>
            </div>
            <div class="modal-body">
                <form id="addressForm" onsubmit="saveAddress(event)" novalidate>
                    <div class="form-row">
                    <div class="form-group">
                        <label for="fullName">Full Name</label>
                        <input type="text" id="fullName" name="fullName" placeholder="Full Name" autocomplete="off" required>
                        <div class="error-message">Please fill out this field</div>
                    </div>
                    <div class="form-group">
                        <label for="phoneNumber">Phone Number</label>
                        <input type="tel" id="phoneNumber" name="phoneNumber" placeholder="Phone Number" autocomplete="off" required>
                        <div class="error-message">Please fill out this field</div>
                    </div>
                    </div>
                    
                    <div class="form-group full-width">
                        <label>Region</label>
                        <select id="region" name="region" autocomplete="off" required onchange="updateProvinces(); validateField(this);">
                            <option value="">Select Region</option>
                        </select>
                        <div class="error-message">Please select an item in the list</div>
                    </div>
                    
                    <div class="form-group full-width">
                        <label>Province</label>
                        <select id="province" name="province" autocomplete="off" required onchange="updateCities(); validateField(this);" disabled>
                            <option value="">Select Province</option>
                        </select>
                        <div class="error-message">Please select an item in the list</div>
                    </div>
                    
                    <div class="form-group full-width">
                        <label>City/Municipality</label>
                        <select id="city" name="city" autocomplete="off" required onchange="updateBarangays(); validateField(this);" disabled>
                            <option value="">Select City/Municipality</option>
                        </select>
                        <div class="error-message">Please select an item in the list</div>
                    </div>
                    
                    <div class="form-group full-width">
                        <label>Barangay</label>
                        <select id="barangay" name="barangay" autocomplete="off" required onchange="validateField(this);" disabled>
                            <option value="">Select Barangay</option>
                        </select>
                        <div class="error-message">Please select an item in the list</div>
                    </div>
                    
                    <div class="form-group full-width">
                        <label for="postalCode">Postal Code</label>
                        <input type="text" id="postalCode" name="postalCode" placeholder="Postal Code" autocomplete="off" required>
                        <div class="error-message">Please fill out this field</div>
                    </div>
                    
                    <div class="form-group full-width">
                        <label for="streetAddress">Street Name, Building, House No.</label>
                        <input type="text" id="streetAddress" name="streetAddress" placeholder="Street Name, Building, House No." autocomplete="off" required>
                        <div class="error-message">Please fill out this field</div>
                    </div>
                    
                    <div class="form-group full-width">
                        <div class="map-placeholder">
                            <button type="button" class="btn-add-location">
                                <i class="fas fa-plus me-2"></i>
                                Add Location
                            </button>
                        </div>
                    </div>
                    
                    <div class="label-section">
                        <span>Label As:</span>
                        <div class="label-buttons">
                            <button type="button" class="label-btn active" data-label="home" onclick="selectLabel(this, 'home')">Home</button>
                            <button type="button" class="label-btn" data-label="work" onclick="selectLabel(this, 'work')">Work</button>
                        </div>
                    </div>
                    
                    <div class="modal-footer">
                        <button type="button" class="btn-cancel" onclick="closeAddressModal(event)">Cancel</button>
                        <button type="submit" class="btn-submit">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Delete Confirmation Modal -->
    <div id="deleteConfirmModal" class="delete-confirm-modal" style="display: none;">
        <div class="delete-confirm-content">
            <div class="delete-confirm-icon-wrapper">
                <div class="delete-confirm-icon">
                    <i class="fas fa-trash-alt"></i>
                </div>
            </div>
            <div class="delete-confirm-body">
                <h3>Confirm Deletion</h3>
                <p id="deleteConfirmMessage">Are you sure you want to delete this item?</p>
            </div>
            <div class="delete-confirm-footer">
                <button type="button" class="btn-confirm-cancel" id="deleteCancelBtn">Cancel</button>
                <button type="button" class="btn-confirm-delete" id="deleteConfirmBtn">Delete</button>
            </div>
        </div>
    </div>
    
    <!-- Checkout Loading Modal -->
    <div id="checkoutLoadingModal" class="checkout-loading-modal" style="display: none;">
        <div class="checkout-loading-content">
            <div class="checkout-loading-icon">
                <div class="checkout-loading-spinner"></div>
                <i class="fas fa-shopping-cart"></i>
            </div>
            <p class="checkout-loading-text">Redirecting to checkout...</p>
            <p class="checkout-loading-subtext">Please wait while we process your order</p>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Preload cart data immediately to prevent layout shifts
        (function() {
            try {
                const cart = JSON.parse(localStorage.getItem('cart')) || [];
                const cartCount = cart.reduce((sum, item) => sum + (item.quantity || 0), 0);
                const totalItems = cart.reduce((sum, item) => sum + (item.quantity || 0), 0);
                
                // Update cart count badge in navbar
                const cartCountElement = document.getElementById('cartCount');
                if (cartCountElement) {
                    cartCountElement.textContent = cartCount;
                    if (cartCount === 0) {
                        cartCountElement.style.display = 'none';
                    } else {
                        cartCountElement.style.display = 'flex';
                    }
                }
                
                // Update item count badge
                const itemCountElement = document.getElementById('itemCount');
                if (itemCountElement) {
                    itemCountElement.textContent = totalItems === 1 ? '1 item' : totalItems === 0 ? '0 items' : `${totalItems} items`;
                }
                
                // Pre-render cart items immediately to prevent layout shift
                const cartItemsList = document.getElementById('cartItemsList');
                const emptyCart = document.getElementById('emptyCart');
                const paginationContainer = document.getElementById('paginationContainer');
                
                if (cartItemsList && cart.length > 0) {
                    // Product icons mapping (needed for pre-render)
                    const productIcons = {
                        1: 'fa-fill-drip',
                        2: 'fa-tint',
                        3: 'fa-wine-bottle',
                        4: 'fa-wine-bottle',
                        5: 'fa-hand-holding-water'
                    };
                    
                    const itemsPerPage = 3;
                    const startIndex = 0;
                    const endIndex = Math.min(itemsPerPage, cart.length);
                    const currentItems = cart.slice(startIndex, endIndex);
                    
                    cartItemsList.innerHTML = currentItems.map((item, localIndex) => {
                        const actualIndex = startIndex + localIndex;
                        const subtotal = item.price * item.quantity;
                        const icon = productIcons[item.id] || 'fa-tint';
                        
                        return `
                            <div class="cart-item" data-item-id="${item.id}" data-cart-index="${actualIndex}">
                                <div class="item-checkbox">
                                    <input type="checkbox" class="item-checkbox-input" checked onchange="updateSummary()">
                                </div>
                                <div class="item-image">
                                    <i class="fas ${icon}"></i>
                                </div>
                                <div class="item-details">
                                    <div class="item-name">${item.name}</div>
                                    <div class="item-price">‚Ç±${item.price.toFixed(2)} per unit</div>
                                </div>
                                <div class="item-quantity">
                                    <div class="quantity-controls">
                                        <button type="button" class="quantity-btn decrease" onclick="updateQuantity(${item.id}, -1)">‚àí</button>
                                        <input type="number" class="quantity-input" id="qty-cart-${item.id}" value="${item.quantity}" min="1" onchange="updateQuantityInput(${item.id})">
                                        <button type="button" class="quantity-btn increase" onclick="updateQuantity(${item.id}, 1)">+</button>
                                    </div>
                                </div>
                                <div class="item-subtotal" id="subtotal-${item.id}">
                                    ‚Ç±${subtotal.toFixed(2)}
                                </div>
                                <button class="item-remove" onclick="removeItem(${item.id})" title="Remove item">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        `;
                    }).join('');
                    
                    if (emptyCart) emptyCart.style.display = 'none';
                    if (paginationContainer && cart.length > itemsPerPage) {
                        paginationContainer.style.display = 'block';
                    }
                } else if (cartItemsList && cart.length === 0) {
                    cartItemsList.innerHTML = '';
                    if (emptyCart) emptyCart.style.display = 'block';
                    if (paginationContainer) paginationContainer.style.display = 'none';
                }
            } catch(e) {
                console.error('Error preloading cart:', e);
            }
        })();
        
        // Product icons mapping
        const productIcons = {
            1: 'fa-fill-drip',
            2: 'fa-tint',
            3: 'fa-wine-bottle',
            4: 'fa-wine-bottle',
            5: 'fa-hand-holding-water'
        };
        
        // Pagination variables
        let currentPage = 1;
        const itemsPerPage = 3;
        
        // Load cart from localStorage
        function loadCart() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const cartItemsList = document.getElementById('cartItemsList');
            const emptyCart = document.getElementById('emptyCart');
            const itemCount = document.getElementById('itemCount');
            const checkoutBtn = document.getElementById('checkoutBtn');
            
            // Update cart count in navbar
            updateCartCount();
            
            if (cart.length === 0) {
                if (cartItemsList) cartItemsList.innerHTML = '';
                if (emptyCart) emptyCart.style.display = 'block';
                const paginationContainer = document.getElementById('paginationContainer');
                if (paginationContainer) paginationContainer.style.display = 'none';
                const itemCountBadge = document.getElementById('itemCount');
                if (itemCountBadge) {
                    itemCountBadge.textContent = '0 items';
                }
                if (checkoutBtn) checkoutBtn.disabled = true;
                updateSummary();
                return;
            }
            
            if (emptyCart) emptyCart.style.display = 'none';
            const itemCountBadge = document.getElementById('itemCount');
            if (itemCountBadge) {
                itemCountBadge.textContent = `${cart.length} ${cart.length === 1 ? 'item' : 'items'}`;
            }
            if (checkoutBtn) updateCheckoutButton(); // Check both cart items and address
            
            // Render pagination
            renderPagination(cart.length);
            
            // Render current page items
            renderCartItems(cart);
        }
        
        function renderCartItems(cart) {
            const cartItemsList = document.getElementById('cartItemsList');
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const currentItems = cart.slice(startIndex, endIndex);
            
            // Get the actual index in the full cart array for data-item-id
            cartItemsList.innerHTML = currentItems.map((item, localIndex) => {
                const actualIndex = startIndex + localIndex;
                const subtotal = item.price * item.quantity;
                const icon = productIcons[item.id] || 'fa-tint';
                
                return `
                    <div class="cart-item" data-item-id="${item.id}" data-cart-index="${actualIndex}">
                        <div class="item-checkbox">
                            <input type="checkbox" class="item-checkbox-input" checked onchange="updateSummary()">
                        </div>
                        <div class="item-image">
                            <i class="fas ${icon}"></i>
                        </div>
                        <div class="item-details">
                            <div class="item-name">${item.name}</div>
                            <div class="item-price">‚Ç±${item.price.toFixed(2)} per unit</div>
                        </div>
                        <div class="item-quantity">
                            <div class="quantity-controls">
                                <button type="button" class="quantity-btn decrease" onclick="updateQuantity(${item.id}, -1)">‚àí</button>
                                <input type="number" class="quantity-input" id="qty-cart-${item.id}" value="${item.quantity}" min="1" onchange="updateQuantityInput(${item.id})">
                                <button type="button" class="quantity-btn increase" onclick="updateQuantity(${item.id}, 1)">+</button>
                            </div>
                        </div>
                        <div class="item-subtotal" id="subtotal-${item.id}">
                            ‚Ç±${subtotal.toFixed(2)}
                        </div>
                        <button class="item-remove" onclick="removeItem(${item.id})" title="Remove item">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
            }).join('');
            
            updateSummary();
        }
        
        function renderPagination(totalItems) {
            const paginationContainer = document.getElementById('paginationContainer');
            const pagination = document.getElementById('pagination');
            const totalPages = Math.ceil(totalItems / itemsPerPage);
            
            if (totalPages <= 1) {
                paginationContainer.style.display = 'none';
                return;
            }
            
            paginationContainer.style.display = 'block';
            
            let paginationHTML = '';
            
            // Previous button
            paginationHTML += `
                <li class="page-item ${currentPage === 1 ? 'disabled' : ''}">
                    <a class="page-link" href="#" onclick="changePage(${currentPage - 1}); return false;">
                        <i class="fas fa-chevron-left"></i>
                    </a>
                </li>
            `;
            
            // Page numbers
            for (let i = 1; i <= totalPages; i++) {
                if (i === 1 || i === totalPages || (i >= currentPage - 1 && i <= currentPage + 1)) {
                    paginationHTML += `
                        <li class="page-item ${i === currentPage ? 'active' : ''}">
                            <a class="page-link" href="#" onclick="changePage(${i}); return false;">${i}</a>
                        </li>
                    `;
                } else if (i === currentPage - 2 || i === currentPage + 2) {
                    paginationHTML += `
                        <li class="page-item disabled">
                            <span class="page-link">...</span>
                        </li>
                    `;
                }
            }
            
            // Next button
            paginationHTML += `
                <li class="page-item ${currentPage === totalPages ? 'disabled' : ''}">
                    <a class="page-link" href="#" onclick="changePage(${currentPage + 1}); return false;">
                        <i class="fas fa-chevron-right"></i>
                    </a>
                </li>
            `;
            
            pagination.innerHTML = paginationHTML;
        }
        
        function changePage(page) {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const totalPages = Math.ceil(cart.length / itemsPerPage);
            
            if (page < 1 || page > totalPages) return;
            
            currentPage = page;
            renderCartItems(cart);
            renderPagination(cart.length);
            
            // Scroll to top of cart items
            document.getElementById('cartItemsList').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
        
        // Update quantity
        function updateQuantity(productId, change) {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const item = cart.find(i => i.id === productId);
            
            if (!item) return;
            
            item.quantity += change;
            
            if (item.quantity < 1) {
                item.quantity = 1;
            }
            
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartCount(); // Update navbar count immediately
            loadCart();
        }
        
        // Update quantity from input
        function updateQuantityInput(productId) {
            const input = document.getElementById(`qty-cart-${productId}`);
            const quantity = parseInt(input.value) || 1;
            
            if (quantity < 1) {
                input.value = 1;
                return;
            }
            
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const item = cart.find(i => i.id === productId);
            
            if (item) {
                item.quantity = quantity;
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartCount(); // Update navbar count immediately
                loadCart();
            }
        }
        
        // Remove item
        function removeItem(productId) {
            showDeleteConfirmModal(() => {
                const cart = JSON.parse(localStorage.getItem('cart')) || [];
                const filteredCart = cart.filter(item => item.id !== productId);
                
                localStorage.setItem('cart', JSON.stringify(filteredCart));
                updateCartCount(); // Update navbar count immediately
                loadCart();
                showNotification('Item removed from cart', 'success');
            }, 'Remove this item from cart?');
        }
        
        // Update summary
        function updateSummary() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const checkboxes = document.querySelectorAll('.item-checkbox-input:checked');
            
            let subtotal = 0;
            checkboxes.forEach(checkbox => {
                const cartItem = checkbox.closest('.cart-item');
                const itemId = parseInt(cartItem.getAttribute('data-item-id'));
                const item = cart.find(i => i.id === itemId);
                
                if (item) {
                    subtotal += item.price * item.quantity;
                }
            });
            
            const deliveryFee = subtotal > 0 ? 50 : 0;
            const total = subtotal + deliveryFee;
            
            document.getElementById('subtotal').textContent = `‚Ç±${subtotal.toFixed(2)}`;
            document.getElementById('deliveryFee').textContent = `‚Ç±${deliveryFee.toFixed(2)}`;
            document.getElementById('total').textContent = `‚Ç±${total.toFixed(2)}`;
            
            // Update checkout button (check both items and address)
            updateCheckoutButton();
        }
        
        // Toggle select all
        function toggleSelectAll() {
            const selectAll = document.getElementById('selectAll');
            const checkboxes = document.querySelectorAll('.item-checkbox-input');
            const deleteAllBtn = document.getElementById('deleteAllBtn');
            
            checkboxes.forEach(checkbox => {
                checkbox.checked = selectAll.checked;
            });
            
            // Show/hide delete all button
            if (selectAll.checked && checkboxes.length > 0) {
                deleteAllBtn.style.display = 'flex';
            } else {
                deleteAllBtn.style.display = 'none';
            }
            
            updateSummary();
        }
        
        // Delete all selected items
        function deleteAllSelected() {
            showDeleteConfirmModal(() => {
                const cart = JSON.parse(localStorage.getItem('cart')) || [];
                const selectedItems = [];
                
                document.querySelectorAll('.item-checkbox-input:checked').forEach(checkbox => {
                    const cartItem = checkbox.closest('.cart-item');
                    const itemId = parseInt(cartItem.getAttribute('data-item-id'));
                    selectedItems.push(itemId);
                });
                
                // Remove selected items from cart
                const updatedCart = cart.filter(item => !selectedItems.includes(item.id));
                localStorage.setItem('cart', JSON.stringify(updatedCart));
                
                // Uncheck select all
                document.getElementById('selectAll').checked = false;
                document.getElementById('deleteAllBtn').style.display = 'none';
                
                loadCart();
                showNotification('Selected items deleted successfully!', 'success');
            }, 'Are you sure you want to delete all selected items?');
        }
        
        // Update cart count in navbar
        function updateCartCount() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const cartCount = cart.reduce((sum, item) => sum + (item.quantity || 0), 0);
            const cartCountElement = document.getElementById('cartCount');
            if (cartCountElement) {
                // Use requestAnimationFrame to prevent layout shift
                requestAnimationFrame(() => {
                    cartCountElement.textContent = cartCount;
                    // Hide badge if count is 0
                    if (cartCount === 0) {
                        cartCountElement.style.display = 'none';
                    } else {
                        cartCountElement.style.display = 'flex';
                    }
                });
            }
        }
        
        // Proceed to checkout
        function proceedToCheckout() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const selectedItems = [];
            
            document.querySelectorAll('.item-checkbox-input:checked').forEach(checkbox => {
                const cartItem = checkbox.closest('.cart-item');
                const itemId = parseInt(cartItem.getAttribute('data-item-id'));
                const item = cart.find(i => i.id === itemId);
                if (item) {
                    selectedItems.push(item);
                }
            });
            
            if (selectedItems.length === 0) {
                showNotification('Please select at least one item', 'error');
                return;
            }
            
            // Store selected items for checkout
            localStorage.setItem('checkoutItems', JSON.stringify(selectedItems));
            
            // Show checkout loading modal
            showCheckoutLoading();
            
            // Redirect to checkout page (you can create this later)
            // setTimeout(() => {
            //     window.location.href = 'checkout.html';
            // }, 2000);
        }
        
        // Show notification
        function showNotification(message, type = 'success') {
            // Don't show notification if it's checkout redirect (we use modal instead)
            if (message === 'Redirecting to checkout...') {
                return;
            }
            
            const notification = document.createElement('div');
            notification.className = `alert alert-${type === 'success' ? 'success' : 'danger'}`;
            notification.style.cssText = 'position: fixed; top: 80px; right: 20px; z-index: 9999; min-width: 300px; box-shadow: 0 4px 20px rgba(0,0,0,0.15);';
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'} me-2"></i>
                ${message}
            `;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transition = 'opacity 0.3s';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }
        
        // Show checkout loading modal
        function showCheckoutLoading() {
            const modal = document.getElementById('checkoutLoadingModal');
            if (modal) {
                modal.style.display = 'flex';
            }
        }
        
        // Hide checkout loading modal
        function hideCheckoutLoading() {
            const modal = document.getElementById('checkoutLoadingModal');
            if (modal) {
                modal.style.display = 'none';
            }
        }
        
        // Laguna Location Data Only (CALABARZON Region)
        const philippineLocations = {
            'CALABARZON': {
                name: 'IV-A ‚Äì CALABARZON',
                provinces: {
                    'Laguna': {
                        cities: {
                            'Alaminos': {
                                barangays: ['Barangay I (Pob.)', 'Barangay II (Pob.)', 'Barangay III (Pob.)', 'Barangay IV (Pob.)', 'Del Carmen', 'Gulod', 'Magsaysay', 'Poblacion', 'San Agustin', 'San Andres', 'San Benito', 'San Gregorio', 'San Isidro', 'San Jose', 'San Juan', 'San Miguel', 'San Pablo', 'San Roque', 'Santa Cruz', 'Santa Maria', 'Santo Ni√±o', 'Santo Tomas']
                            },
                            'Bay': {
                                barangays: ['Bitin', 'Calo', 'Dila', 'Maitim', 'Masaya', 'Paciano Rizal', 'Puypuy', 'San Agustin', 'San Antonio', 'San Isidro', 'Tagumpay', 'Tranca']
                            },
                            'Bi√±an': {
                                barangays: ['Bungahan', 'Canlalay', 'Casile', 'De La Paz', 'Ganado', 'Langkiwa', 'Loma', 'Malaban', 'Malamig', 'Mampalasan', 'Platero', 'Poblacion', 'San Antonio', 'San Francisco', 'San Jose', 'San Vicente', 'Santo Domingo', 'Santo Ni√±o', 'Santo Tomas', 'Soro-Soro', 'Timbao', 'Tubigan', 'Zapote']
                            },
                            'Calauan': {
                                barangays: ['San Isidro', 'Poblacion I', 'Poblacion II', 'Poblacion III', 'Poblacion IV', 'Bubukal', 'Masili', 'Dayap', 'Lamot I', 'Lamot II', 'Limao', 'Mabacan', 'Masiit', 'Paliparan', 'Pansol', 'San Antonio', 'San Cristobal', 'San Juan', 'San Pablo', 'San Salvador', 'Santo Tomas', 'Santo Toribio', 'Talangan', 'Tambo', 'Tiaong', 'Tulay', 'Ulat', 'Ulong Tubig', 'Villa Espina', 'Villa Mercedes']
                            },
                            'Calamba': {
                                barangays: ['Bagong Kalsada', 'Banadero', 'Banlic', 'Barandal', 'Bucal', 'Bunggo', 'Burol', 'Camaligan', 'Canlubang', 'Halang', 'Hornalan', 'Kay-Anlog', 'La Mesa', 'Laguerta', 'Lawa', 'Lecheria', 'Lingga', 'Looc', 'Mabato', 'Majada Labas', 'Makiling', 'Mapagong', 'Masili', 'Maunong', 'Mayapa', 'Paciano Rizal', 'Palingon', 'Palo-Alto', 'Pansol', 'Parian', 'Prinza', 'Pulo', 'Puting Lupa', 'Real', 'Saimsim', 'Sampiruhan', 'San Cristobal', 'San Jose', 'San Juan', 'San Nicolas', 'San Roque', 'Santo Tomas', 'Sucol', 'Turbina', 'Ulango', 'Uwisan']
                            },
                            'Los Ba√±os': {
                                barangays: ['Anos', 'Bagong Silang', 'Bambang', 'Batong Malake', 'Baybayin', 'Lalakay', 'Maahas', 'Malinta', 'Mayondon', 'Putho-Tuntungin', 'San Antonio', 'Tadlac', 'Timugan']
                            },
                            'San Pedro': {
                                barangays: ['Bagong Silang', 'Calendola', 'Cuyab', 'Estrella', 'Landayan', 'Langgam', 'Magsaysay', 'Narra', 'Nueva', 'Pacita Complex I', 'Pacita Complex II', 'Poblacion', 'Rosario', 'San Antonio', 'San Roque', 'San Vicente', 'Santo Ni√±o', 'United Bayanihan', 'United Better Living']
                            },
                            'Santa Rosa': {
                                barangays: ['Aplaya', 'Balibago', 'Caingin', 'Dila', 'Labas', 'Macabling', 'Malitlit', 'Malusak', 'Poblacion', 'Pulong Santa Cruz', 'Sinalhan', 'Tagapo']
                            },
                            'Sta. Cruz': {
                                barangays: ['Bagumbayan', 'Bubukal', 'Calios', 'Duhat', 'Gatid', 'Jasaan', 'Labuin', 'Malinao', 'Oogong', 'Pagsawitan', 'Paiisa', 'Palasan', 'Patimbao', 'San Jose', 'San Juan', 'San Pablo Norte', 'San Pablo Sur', 'Santo Angel Norte', 'Santo Angel Sur', 'Santo Domingo', 'Tagbakin', 'Tuburan']
                            }
                        }
                    }
                }
            }
        };
        
        // Initialize location dropdowns
        function initializeLocationDropdowns() {
            const regionSelect = document.getElementById('region');
            if (!regionSelect) return;
            
            // Clear existing options
            regionSelect.innerHTML = '<option value="">Select Region</option>';
            
            // Populate regions (only Laguna now)
            Object.keys(philippineLocations).forEach(regionCode => {
                const region = philippineLocations[regionCode];
                const option = document.createElement('option');
                option.value = regionCode;
                option.textContent = region.name;
                regionSelect.appendChild(option);
            });
            
            // Auto-select CALABARZON if it's the only region
            if (Object.keys(philippineLocations).length === 1) {
                regionSelect.value = Object.keys(philippineLocations)[0];
                updateProvinces();
            }
        }
        
        // Update provinces based on selected region
        function updateProvinces() {
            const regionSelect = document.getElementById('region');
            const provinceSelect = document.getElementById('province');
            const citySelect = document.getElementById('city');
            const barangaySelect = document.getElementById('barangay');
            
            const selectedRegion = regionSelect.value;
            
            // Reset dependent dropdowns
            provinceSelect.innerHTML = '<option value="">Select Province</option>';
            citySelect.innerHTML = '<option value="">Select City/Municipality</option>';
            barangaySelect.innerHTML = '<option value="">Select Barangay</option>';
            
            if (selectedRegion && philippineLocations[selectedRegion]) {
                provinceSelect.disabled = false;
                const provinces = philippineLocations[selectedRegion].provinces;
                
                Object.keys(provinces).forEach(provinceName => {
                    const option = document.createElement('option');
                    option.value = provinceName;
                    option.textContent = provinceName;
                    provinceSelect.appendChild(option);
                });
            } else {
                provinceSelect.disabled = true;
                citySelect.disabled = true;
                barangaySelect.disabled = true;
            }
        }
        
        // Update cities based on selected province
        function updateCities() {
            const regionSelect = document.getElementById('region');
            const provinceSelect = document.getElementById('province');
            const citySelect = document.getElementById('city');
            const barangaySelect = document.getElementById('barangay');
            
            const selectedRegion = regionSelect.value;
            const selectedProvince = provinceSelect.value;
            
            // Reset dependent dropdowns
            citySelect.innerHTML = '<option value="">Select City/Municipality</option>';
            barangaySelect.innerHTML = '<option value="">Select Barangay</option>';
            
            if (selectedRegion && selectedProvince && philippineLocations[selectedRegion]) {
                const province = philippineLocations[selectedRegion].provinces[selectedProvince];
                if (province) {
                    citySelect.disabled = false;
                    const cities = province.cities;
                    
                    Object.keys(cities).forEach(cityName => {
                        const option = document.createElement('option');
                        option.value = cityName;
                        option.textContent = cityName;
                        citySelect.appendChild(option);
                    });
                }
            } else {
                citySelect.disabled = true;
                barangaySelect.disabled = true;
            }
        }
        
        // Update barangays based on selected city
        function updateBarangays() {
            const regionSelect = document.getElementById('region');
            const provinceSelect = document.getElementById('province');
            const citySelect = document.getElementById('city');
            const barangaySelect = document.getElementById('barangay');
            
            const selectedRegion = regionSelect.value;
            const selectedProvince = provinceSelect.value;
            const selectedCity = citySelect.value;
            
            // Reset barangay dropdown
            barangaySelect.innerHTML = '<option value="">Select Barangay</option>';
            
            if (selectedRegion && selectedProvince && selectedCity && philippineLocations[selectedRegion]) {
                const province = philippineLocations[selectedRegion].provinces[selectedProvince];
                if (province && province.cities[selectedCity]) {
                    barangaySelect.disabled = false;
                    const barangays = province.cities[selectedCity].barangays;
                    
                    barangays.forEach(barangayName => {
                        const option = document.createElement('option');
                        option.value = barangayName;
                        option.textContent = barangayName;
                        barangaySelect.appendChild(option);
                    });
                }
            } else {
                barangaySelect.disabled = true;
            }
        }
        
        // Address Management
        function loadAddress() {
            const address = JSON.parse(localStorage.getItem('deliveryAddress'));
            const emptyAddress = document.getElementById('emptyAddress');
            const addressDisplay = document.getElementById('addressDisplay');
            const checkoutBtn = document.getElementById('checkoutBtn');
            
            if (address) {
                emptyAddress.style.display = 'none';
                addressDisplay.style.display = 'block';
                document.getElementById('addressName').textContent = address.fullName;
                document.getElementById('addressPhone').textContent = `(${address.phoneNumber})`;
                
                // Display full address with location breakdown
                let locationText = '';
                if (address.barangay && address.city && address.province) {
                    locationText = `${address.streetAddress}, ${address.barangay}, ${address.city}, ${address.province} ${address.postalCode || ''}`;
                } else if (address.location) {
                    // Fallback for old format
                    locationText = `${address.streetAddress}, ${address.location}, ${address.postalCode || ''}`;
                } else {
                    locationText = `${address.streetAddress}, ${address.postalCode || ''}`;
                }
                document.getElementById('addressText').textContent = locationText.trim();
                
                if (address.isDefault) {
                    document.getElementById('defaultBadge').style.display = 'block';
                } else {
                    document.getElementById('defaultBadge').style.display = 'none';
                }
                
                // Enable checkout button if cart has items
                updateCheckoutButton();
            } else {
                emptyAddress.style.display = 'block';
                addressDisplay.style.display = 'none';
                // Disable checkout button if no address
                if (checkoutBtn) {
                    checkoutBtn.disabled = true;
                }
            }
        }
        
        function updateCheckoutButton() {
            const checkoutBtn = document.getElementById('checkoutBtn');
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const address = JSON.parse(localStorage.getItem('deliveryAddress'));
            const selectedItems = document.querySelectorAll('.item-checkbox-input:checked');
            
            if (checkoutBtn) {
                // Disable if no address or no items selected
                if (!address || selectedItems.length === 0 || cart.length === 0) {
                    checkoutBtn.disabled = true;
                } else {
                    checkoutBtn.disabled = false;
                }
            }
        }
        
        function openAddressModal() {
            const modal = document.getElementById('addressModal');
            if (!modal) {
                console.error('Address modal not found');
                return;
            }
            
            const address = JSON.parse(localStorage.getItem('deliveryAddress'));
            
            // Initialize location dropdowns first
            initializeLocationDropdowns();
            
            if (address) {
                // Populate form with existing address
                document.getElementById('fullName').value = address.fullName || '';
                document.getElementById('phoneNumber').value = address.phoneNumber || '';
                document.getElementById('postalCode').value = address.postalCode || '';
                document.getElementById('streetAddress').value = address.streetAddress || '';
                
                // Restore location if saved
                if (address.region) {
                    document.getElementById('region').value = address.region;
                    updateProvinces();
                    setTimeout(() => {
                        if (address.province) {
                            document.getElementById('province').value = address.province;
                            updateCities();
                            setTimeout(() => {
                                if (address.city) {
                                    document.getElementById('city').value = address.city;
                                    updateBarangays();
                                    setTimeout(() => {
                                        if (address.barangay) {
                                            document.getElementById('barangay').value = address.barangay;
                                        }
                                    }, 100);
                                }
                            }, 100);
                        }
                    }, 100);
                }
                
                // Set label
                document.querySelectorAll('.label-btn').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.dataset.label === address.label) {
                        btn.classList.add('active');
                    }
                });
            } else {
                // Reset form
                document.getElementById('addressForm').reset();
                document.getElementById('region').value = '';
                document.getElementById('province').innerHTML = '<option value="">Select Province</option>';
                document.getElementById('province').disabled = true;
                document.getElementById('city').innerHTML = '<option value="">Select City/Municipality</option>';
                document.getElementById('city').disabled = true;
                document.getElementById('barangay').innerHTML = '<option value="">Select Barangay</option>';
                document.getElementById('barangay').disabled = true;
                document.querySelectorAll('.label-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelector('.label-btn[data-label="home"]').classList.add('active');
            }
            
            // Add validation listeners using event delegation
            const form = document.getElementById('addressForm');
            if (form) {
                // Use event delegation to handle all input/change events
                form.addEventListener('input', function(e) {
                    if (e.target.matches('input, select')) {
                        if (e.target.checkValidity()) {
                            validateField(e.target);
                        }
                    }
                }, true);
                form.addEventListener('change', function(e) {
                    if (e.target.matches('input, select')) {
                        validateField(e.target);
                    }
                }, true);
            }
            
            // Show modal
            modal.classList.add('active');
            document.body.style.overflow = 'hidden'; // Prevent background scrolling
        }
        
        function closeAddressModal(event) {
            if (event && event.target.id !== 'addressModal' && !event.target.closest('.address-modal')) return;
            const modal = document.getElementById('addressModal');
            if (modal) {
                modal.classList.remove('active');
                document.body.style.overflow = ''; // Restore scrolling
            }
        }
        
        function selectLabel(button, label) {
            document.querySelectorAll('.label-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            button.classList.add('active');
        }
        
        // Custom validation function
        function validateField(field) {
            const formGroup = field.closest('.form-group');
            if (field.checkValidity()) {
                formGroup.classList.remove('error');
            } else {
                formGroup.classList.add('error');
            }
        }
        
        // Add event listeners to clear errors on input
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('addressForm');
            if (form) {
                const fields = form.querySelectorAll('input, select');
                fields.forEach(field => {
                    field.addEventListener('input', function() {
                        if (this.checkValidity()) {
                            validateField(this);
                        }
                    });
                    field.addEventListener('change', function() {
                        validateField(this);
                    });
                });
            }
        });
        
        // Validate all fields on form submit
        function validateForm() {
            const form = document.getElementById('addressForm');
            const fields = form.querySelectorAll('input[required], select[required]');
            let isValid = true;
            
            fields.forEach(field => {
                validateField(field);
                if (!field.checkValidity()) {
                    isValid = false;
                }
            });
            
            return isValid;
        }
        
        function saveAddress(event) {
            event.preventDefault();
            
            // Validate all fields
            if (!validateForm()) {
                // Scroll to first error
                const firstError = document.querySelector('.form-group.error');
                if (firstError) {
                    firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
                return;
            }
            
            const region = document.getElementById('region').value;
            const province = document.getElementById('province').value;
            const city = document.getElementById('city').value;
            const barangay = document.getElementById('barangay').value;
            
            if (!region || !province || !city || !barangay) {
                showNotification('Please complete all location fields', 'error');
                return;
            }
            
            const address = {
                fullName: document.getElementById('fullName').value,
                phoneNumber: document.getElementById('phoneNumber').value,
                region: region,
                province: province,
                city: city,
                barangay: barangay,
                location: `${barangay}, ${city}, ${province}`, // For backward compatibility
                postalCode: document.getElementById('postalCode').value,
                streetAddress: document.getElementById('streetAddress').value,
                label: document.querySelector('.label-btn.active').dataset.label,
                isDefault: true // First address is always default
            };
            
            localStorage.setItem('deliveryAddress', JSON.stringify(address));
            loadAddress();
            updateCheckoutButton(); // Enable checkout when address is saved
            closeAddressModal();
            showNotification('Delivery address saved successfully!', 'success');
        }
        
        function deleteAddress() {
            showDeleteConfirmModal(() => {
                localStorage.removeItem('deliveryAddress');
                loadAddress();
                updateCheckoutButton(); // Disable checkout when address is deleted
                showNotification('Delivery address deleted successfully!', 'success');
            }, 'Are you sure you want to delete this delivery address?');
        }
        
        // Show delete confirmation modal
        function showDeleteConfirmModal(onConfirm, message) {
            const modal = document.getElementById('deleteConfirmModal');
            const messageEl = document.getElementById('deleteConfirmMessage');
            const confirmBtn = document.getElementById('deleteConfirmBtn');
            const cancelBtn = document.getElementById('deleteCancelBtn');
            
            messageEl.textContent = message;
            modal.style.display = 'flex';
            
            // Remove existing event listeners
            const newConfirmBtn = confirmBtn.cloneNode(true);
            const newCancelBtn = cancelBtn.cloneNode(true);
            confirmBtn.parentNode.replaceChild(newConfirmBtn, confirmBtn);
            cancelBtn.parentNode.replaceChild(newCancelBtn, cancelBtn);
            
            // Add new event listeners
            newConfirmBtn.addEventListener('click', function confirmHandler() {
                modal.style.display = 'none';
                onConfirm();
                newConfirmBtn.removeEventListener('click', confirmHandler);
            });
            
            newCancelBtn.addEventListener('click', function cancelHandler() {
                modal.style.display = 'none';
                newCancelBtn.removeEventListener('click', cancelHandler);
            });
        }
        
        // Initialize
        loadCart();
        loadAddress();
        initializeLocationDropdowns();
        
        // Navbar scroll effect (only shadow, no size changes)
        window.addEventListener('scroll', function() {
            const navbar = document.querySelector('.navbar');
            if (window.scrollY > 50) {
                navbar.style.boxShadow = '0 4px 30px rgba(0, 0, 0, 0.15)';
            } else {
                navbar.style.boxShadow = '0 2px 20px rgba(0, 0, 0, 0.1)';
            }
        });
        
        // Ensure navbar maintains fixed size and prevent layout shift
        function fixNavbarSize() {
            const navbar = document.querySelector('.navbar');
            if (navbar) {
                // Set all size properties immediately
                navbar.style.setProperty('height', '70px', 'important');
                navbar.style.setProperty('min-height', '70px', 'important');
                navbar.style.setProperty('max-height', '70px', 'important');
                navbar.style.setProperty('padding', '0', 'important');
                navbar.style.setProperty('line-height', '70px', 'important');
                navbar.style.setProperty('position', 'fixed', 'important');
                navbar.style.setProperty('top', '0', 'important');
                navbar.style.setProperty('transition', 'none', 'important');
            }
            
            // Also ensure body padding is set
            document.body.style.setProperty('padding-top', '70px', 'important');
        }
        
        // Fix navbar size immediately (before DOM is ready)
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', fixNavbarSize);
        } else {
            fixNavbarSize();
        }
        
        // Also fix on all other events
        window.addEventListener('load', fixNavbarSize);
        window.addEventListener('pageshow', function(e) {
            fixNavbarSize();
            // Force reflow to prevent shake
            void document.body.offsetHeight;
        });
        
        // Fix immediately on script execution
        fixNavbarSize();
    </script>
    
    <!-- Footer -->
    <footer id="contact" class="footer">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 mb-4">
                    <h4 class="footer-title" style="display: flex; align-items: center;">
                        <img src="systemlogo.png" alt="AquaSphere Logo" style="height: 40px; margin-right: 10px;">
                        AquaSphere
                    </h4>
                    <p style="color: rgba(255, 255, 255, 0.8); line-height: 1.7;">
                        Your trusted water delivery service. Fast delivery, clean quality water, and reliable service. 
                        Everything you need for your hydration needs, all in one platform.
                    </p>
                </div>
                
                <div class="col-lg-2 col-md-6 mb-4">
                    <h5 class="footer-title">Quick Links</h5>
                    <a href="index.html" class="footer-link">Home</a>
                    <a href="#features" class="footer-link">Features</a>
                    <a href="#how-it-works" class="footer-link">How It Works</a>
                    <a href="#contact" class="footer-link">Contact</a>
                </div>
                
                <div class="col-lg-3 col-md-6 mb-4">
                    <h5 class="footer-title">Features</h5>
                    <a href="#" class="footer-link">Easy Ordering</a>
                    <a href="#" class="footer-link">Delivery Tracking</a>
                    <a href="#" class="footer-link">Payment Options</a>
                    <a href="#" class="footer-link">Customer Support</a>
                </div>
                
                <div class="col-lg-3 mb-4">
                    <h5 class="footer-title">Connect With Us</h5>
                    <div class="social-icons">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                    <p class="mt-1" style="color: rgba(255, 255, 255, 0.8);">
                        <i class="fas fa-envelope me-2"></i>support@aquasphere.com
                    </p>
                </div>
            </div>
            
            <hr style="border-color: rgba(255, 255, 255, 0.2); margin: 1rem 0 0.8rem;">
            
            <div class="text-center" style="color: rgba(255, 255, 255, 0.8); font-size: 0.8rem;">
                <p>&copy; 2024 AquaSphere. Made with ‚ù§Ô∏è for clean water delivery. All rights reserved.</p>
            </div>
        </div>
    </footer>
</body>
</html>

